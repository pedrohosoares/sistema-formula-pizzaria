<?/** * Função de envio de e-mail personalizado */require_once 'classe/log.php';function enviar_email ($email_origem, $email_destino, $assunto, $texto, $arr_param = array(), $tipo_email = '', $bcc = '', $debug = false,$conexao = false){    require_once 'config.php';    require_once 'sys/lib/php/phpmailer/class.phpmailer.php';    $log = new Log();        /*    $headers = "MIME-Version: 1.1\n";    $headers .= "Content-Type: text/html; charset=iso-8859-1\n";    $headers .= "From: $email_origem\n"; // remetente    if ($bcc)    {        $headers .= "Bcc: $bcc\n";    }    $headers .= "Return-Path: $email_origem\n"; // return-path    */    $msg_email = "";    //$msg_email .= '<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">';    //$msg_email .= "<html>";    //$msg_email .= '<head><meta http-equiv=Content-Type content="text/html; charset=windows-1252"></head>';    //$msg_email .= "<body bgcolor='#83471A' style='text-align: center;font-family: verdana'>";    //$msg_email .= '<div>';    $msg_email .= '<table align="center" border="0" cellpadding="0" cellspacing="0" width="607">';    if($tipo_email != '')    {      $msg_email .= '<tr><td width="607"  style="line-height: 0px;"><img src="http://' . HOST . '/img/email_topo.png"></td></tr>';      //$msg_email .= '<tr><td width="607"  style="line-height: 0px;"><img src="http://192.168.0.150/~thiagojose/comic/fontes/site/img/email_topo.png"></td></tr>';      //$msg_email .= '<tr><td style="line-height: 0;"><img src="http://192.168.0.108/~thiagojose/osmuzzarellas/fontes/site/img/pc/email_'. $tipo_email .'.png"></td></tr>';    }    else    {      $msg_email .= '<tr><td width="607" style="line-height: 0px;"><img src="http://' . HOST . '/img/email_topo.png"></td></tr>';      //$msg_email .= '<tr><td width="607"  style="line-height: 0px;"><img src="http://192.168.0.150/~thiagojose/comic/fontes/site/img/email_topo.png"></td></tr>';    }        if($tipo_email == 'resumo_pedido')    {      $msg_email .= '<tr><td background="http://' . HOST . '/img/pc/email_meio_resumo_pedido.png" width="607" style="padding: 20px 70px; font-family: Verdana; font-size: small;" align="left">';      //$msg_email .= '<tr><td background="http://192.168.0.150/~thiagojose/comic/fontes/site/img/email_meio.png" width="607" style="padding: 20px 70px; font-family: Verdana; font-size: small;" align="left">';      $msg_email .= $texto;      $msg_email .= '</td></tr>';      $msg_email .= '<tr><td width="607" background="http://' . HOST . '/img/email_rodape.png">';      //$msg_email .= '<tr><td width="607" background="http://192.168.0.150/~thiagojose/comic/fontes/site/img/email_rodape.png">';      $msg_email .= '</td></tr>';    }    else    {      $msg_email .= '<tr><td background="http://' . HOST . '/img/email_meio.png" width="607" style="padding: 20px 70px; font-family: Verdana; font-size: small;" align="left">';      //$msg_email .= '<tr><td background="http://192.168.0.150/~thiagojose/comic/fontes/site/img/email_meio.png" width="607" style="padding: 20px 70px; font-family: Verdana; font-size: small;" align="left">';      $msg_email .= $texto;      $msg_email .= '</td></tr>';      $msg_email .= '<tr><td width="607" background="http://' . HOST . '/img/email_meio.png">';      //$msg_email .= '<tr><td width="607" background="http://192.168.0.150/~thiagojose/comic/fontes/site/img/email_meio.png">';      $msg_email .= '<tr><td><a href="'. HOST .'" title="'.NOME_FANTASIA.'"><img src="http://'. HOST .'/img/email_rodape.png"><a></td></tr>';      //$msg_email .= '<tr><td><a href="'. HOST .'" title="'.NOME_FANTASIA.'"><img src="http://192.168.0.150/~thiagojose/comic/fontes/site/img/email_rodape.png"><a></td></tr>';               $msg_email .= '</td></tr>';    }        //$msg_email .= '<tr><td><img src="http://' . HOST . '/img/pc/email_bottom.png"></td></tr>';    //$msg_email .= '<tr><td background="http://192.168.0.108/~thiagojose/osmuzzarellas/fontes/site/img/pc/email_bottom.png">';        $msg_email .= '</table>';    //$msg_email .= '</div>';    //$msg_email .= "</body>";    //$msg_email .= "</html>";        if ($debug)    {        echo $msg_email;    }    $mail = new PHPMailer();    $mail->CharSet = 'UTF-8';    $mail->IsSMTP();    $mail->SMTPDebug = 0;    $mail->SMTPAuth = true;    //$mail->AddCustomHeader('Errors-To: ' . $email_origem);    $mail->AddCustomHeader('Return-Path: ' . $email_origem);    $mail->AddCustomHeader('X-Complaints-To: ' . $email_origem);    $mail->AddCustomHeader('X-Mailer: iPizza - http://internetsistemas.com.br');    $mail->AddCustomHeader('X-Abuse-Info: ' . HOST);    $mail->AddCustomHeader('X-ListMember: ' . $email_destino);/*    $mail->Host = 'mail.osmuzzarellas.com';    $mail->Port = 587;    $mail->Username = 'contato@osmuzzarellas.com';    $mail->Password = 'osmuzza';*/    //$mail->Port = 443;    //$mail->Host = "email-smtp.us-east-1.amazonaws.com";    //$mail->Username = "AKIAJGQ24Z74UZUXQP5A";    //$mail->Password = "AoIWmVRI5vLEDqfErahqFw/DLrAEqQPDRKx2W24H2m2v";    $mail->SMTPSecure = 'ssl';    $mail->Host = 'smtp.gmail.com';    $mail->Port = 465;    $mail->Username = 'teste@internetsistemas.com.br';    $mail->Password = 'teste123';        //$mail->SetFrom($email_origem, 'Os Muzzarellas');    $mail->SetFrom('contato@formulapizzaria.com.br', TIPO_EMPRESA . ' ' . NOME_FANTASIA);    //echo "<br>aki: ".$email_destino;    $arr_emails = explode(",", trim($email_destino));        for ($x=0; $x<count($arr_emails); $x++)    {    	$mail->AddAddress($arr_emails[$x]);    }        $mail->Subject = utf8_encode($assunto);    $mail->AltBody = "Para visualizar esta mensagem utilize um leitor de e-mail compatível com HTML.";    $mail->MsgHTML(utf8_encode($msg_email));        $res = $mail->Send();        //print_r($arr_param);    if (!$res)    {        echo "Mailer Error: " . $mail->ErrorInfo . "<br>";        $log->log_email($conexao, $arr_param['tipo'], 0, $mail->ErrorInfo, $arr_param['cod_pedidos'], $arr_param['cod_usuarios'], $arr_param['cod_clientes'], $arr_param['cod_pizzarias']);    }    else    {        $log->log_email($conexao, $arr_param['tipo'], 1, "", $arr_param['cod_pedidos'], $arr_param['cod_usuarios'], $arr_param['cod_clientes'], $arr_param['cod_pizzarias']);    }        return $res;    //return mail($email_destino, $assunto, $msg_email, $headers);}function enviaEmail($email_origem, $email_destino, $assunto, $texto, $bcc = '', $debug = false){  return enviar_email($email_origem, $email_destino, $assunto, $texto, array(), '', $bcc, $debug);}?>